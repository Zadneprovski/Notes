## Генерация пары закрытый/открытый ключ алгоритма RSA

Недостатки:

	Не обеспечивается совершенная прямая секретность (Perfect forward secrecy);
		- Доступ к закрытому ключу сервера позволит расшифровать все данные 
	
	Есть уязвимости.


#### 1. Выбор двух простых чисел:

- Начнем с выбора двух **очень больших простых чисел**. Назовем их $p$ и $q$.
- Простые числа — это такие числа, которые делятся только на 1 и на себя. Например, 3, 5, 7, 11 и т.д.

#### 2. Умножение чисел $p$ и $q$:

- Теперь умножаем ppp и qqq друг на друга. Обозначим результат как nnn. Это число nnn станет частью **открытого ключа**.

	Например:

$$p=61, q=53,  n = p \times q = 61 \times 53 = 3233$$
#### 3. Вычисление функции Эйлера $\phi(n)$:

- Далее вычисляем так называемую **функцию Эйлера** для $n$. Она равна произведению чисел $p-1$ и $q−1$. Обозначим её как $\phi(n)$.

$$\phi(n) = (p - 1) \times (q - 1)$$

    Пример:

$$\phi(n) = (61 - 1) \times (53 - 1) = 60 \times 52 = 3120$$

#### 4. Выбор числа e:

- Теперь выбираем число e, которое будет использоваться как часть **открытого ключа**. Это число должно быть:
    
    1. Меньше $\phi(n)$.
    2. Взаимно простым с $\phi(n)$ — это значит, что у них нет общих делителей, кроме 1.
    
    Обычно выбирают небольшое фиксированное число, например $e=17$, потому что оно удовлетворяет этим условиям во многих случаях.

#### 5. Вычисление закрытого ключа d:

- Теперь нужно найти число d — это будет ваш **закрытый ключ**. d должно быть таким, чтобы выполнялось уравнение:

$$(e \times d) \mod \phi(n) = 1$$

    Это значит, что $e \times d$, делённое на $\phi(n)$, даёт остаток 1. На этом этапе используется **расширенный алгоритм Евклида** для нахождения d.
    
    Пример: Если $e=17$ и $\phi(n) = 3120$, решаем уравнение:

$$(17 \times d) \mod 3120 = 1$$

    Решив это, находим $d = 2753$.


#### 6. Открытый и закрытый ключ:

- Теперь у вас есть:
    - **Открытый ключ**: (e, n), например (17,3233).
    - **Закрытый ключ**: (d,n), например (2753,3233).

### Как это работает на практике:

1. **Шифрование с помощью открытого ключа**:
    
    Если кто-то хочет отправить вам сообщение, он берет ваше сообщение (например, число) и возводит его в степень eee, а затем берёт остаток от деления на nnn. Это зашифрованное сообщение.
   
$$\text{Шифротекст} = (\text{Сообщение}^e) \mod n$$

    Пример: Если сообщение — это число 123, то вычисляем:

$$\text{Шифротекст} = (123^{17}) \mod 3233 = 855$$

    Теперь 855 — это зашифрованное сообщение.

2. **Расшифровка с помощью закрытого ключа**:

    Для расшифровки вы используете свой закрытый ключ d. Берете шифротекст и возводите его в степень d, а затем берёте остаток от деления на n.

$$\text{Сообщение} = (\text{Шифротекст}^d) \mod n$$
    Пример:

$$\text{Сообщение} = (855^{2753}) \mod 3233 = 123$$
