Напряжение GND-CAN H и GND-CAN L примерно 2,3В

**CAN шина – это сеть обмена данными определенная в стандарте ISO 11898**.  Другие каналы обмена данными в автомобиле не могут быть названы CAN шиной. AVC-LAN, BEAN, J1708, VAN и другие старые протоколы это НЕ CAN !

В автомобиле может быть более одной CAN шины. Для каждого функционального сегмента автомобиля выделяется своя сеть CAN.  Выделенные сети могут работать на разных скоростях.

## Скорости работы CAN шины

CAN на разных автомобилях и в разных сегментах сети может работать на разных скоростях.

Названия сегментов сети: Мотор, Шасси, Комфорт, Салон – условны!  У Каждого автопроизводителя свои названия этих участков сети!

- **Группа VAG**:  Мотор\шасси – 500 кбит\с, Комфорт – 100 кбит\с и с 2018 года шина Комфорт может иметь скорость 500 кбит\с., Диагностика: 500 кбит\с.
- **BMW**: Мотор\Шасси – 500кбит\с, Комфорт – 100 кбит\с и с 2018 года шина Комфорт может иметь скорость 500 кбит\с., Диагностика: 500 кбит\с.
- **Mercedes-Benz**: Мотор\Шасси – 500 кбит\с, Комфорт 83.333 кбит\с, 250 кбит\с, Диагностика: 500 кбит\с. С 2021 года автомобили могут иметь шину **[CAN-FD](https://canhacker.ru/what-is-can-fd/)** c различными парами скоростей (смотри руководства MercedesBenz).
- **Ford, Mazda**:  Мотор\Шасси – 500 кбит\с, Комфорт 125 кбит\с.  (Для Ford может быть больше вариантов)
- **KIA\Hyundai**: Мотор\Шасси – 500 кбит\с, Комфорт 125 кбит\с, 500 кбит\с, Мультимедиа:  125 кбит\с, 500 кбит\с., Диагностика: 500 кбит\с. С 2021 года автомобиль может быть оборудован шиной **[CAN-FD](https://canhacker.ru/what-is-can-fd/)** со скоростью 500\2000 кбит\с.
- **GM**: Мотор\Шасси – 500 кбит\с, Комфорт: 33.333 кбит\с, 95.2 кбит\с, Диагностика: 500 кбит\с.С 2021 года автомобили могут иметь шину **[CAN-FD](https://canhacker.ru/what-is-can-fd/)** c различными парами скоростей.
- **Toyota, Nissan, Honda, Subaru, Suzuki**: 500 кбит\с (может использоваться гейтвей! Изучайте сетевую архитектуру автомобиля!)
- **Mitsubishi**: Мотор\Шасси: 500 кбит\с, Салон\Комфорт – 83.333 кбит\с, 250 кбит\с, Диагностика: 500 кбит\с.
- **Volvo**:  Мотор\Шасси: 500 кбит\с, Салон\Комфорт – 500 кбит\с,  125 кбит\с, Диагностика: 500 кбит\с.
- **Renault**: 500 кбит\с
- **Peugeot**: Мотор\Шасси – 500 кбит\с, Комфорт 125 кбит\с.
- **Lada**: 500 кбит\с
- **Коммерческая и специальная техника**: Стандарт J1939 250 или 500 кбит\с.

## Сегментация CAN шины по функциональному назначению

- Как правило разные, сегменты сети разделены специальным устройством, которое называется **Гейтвей (Gateway, ZGW, ETACS, ICU)** .
- В роли гейтвея может выступать панель приборов (для простых автомобилей) или отдельный специальный модуль межсетевого интерфейса.
- Гейтвей разделяет потоки данных в разных сегментах сети и обеспечивает связь сегментов сети работающих на разных скоростях.
- **ВАЖНО:**  На многих современных автомобилях CAN шина в диагностическом разъеме OBD2 отделена от других участков сети при помощи гейтвея (Gateway), поэтому подключившись к CAN шине OBD разъема **невозможно** увидеть поток данных. В этом случае можно увидеть только обмен между диагностическим инструментом и автомобилем во время процесса диагностики! Так же модулем **Gateway** оборудованы автомобили японских марок  >2016г. в зависимости от модели. Автомобили немецких марок оборудуются таким модулем с момента появления в них CAN шины.
- **ОБЯЗАТЕЛЬНО** изучайте схемы на исследуемый автомобиль, чтобы знать к какому сегменту сети Вы подключаетесь!

Схема ниже изображена в общем виде для упрощения понимания роли Гейтвея. Количество CAN шин и варианты включения блоков управления к тому или другому сегменту сети могут отличаться.

![[Pasted image 20241115135201.png]]


## Реализации CAN на уровне электрических сигналов

CAN шина может быть реализована физически тремя способами:

### **1 ISO11898-2 или CAN-High Speed**.

Классическая витая пара нагруженная с обоих концов резисторами 120 Ом.

![[Pasted image 20241115135220.png]]
В этом случае уровни на шине CAN выглядят так:

![[Pasted image 20241115135247.png]]

Для такой реализации сети используются как правило обычные CAN трансиверы в 8 выводном корпусе, аналоги PCA82C250, TJA1050 и им подобные. Работает такая конфигурация на скоростях 500 кбит\с и выше. (Но могут быть исключения) .

### 2 **ISO11898-3 или CAN-Low Speed или Faut Tolerant CAN**

В этом варианте используется та же витая пара, но линии CAN-Low и CAN-High подтянуты к напряжению питания и массе соответственно.

![[Pasted image 20241115135307.png]]

Такой вариант CAN шины способен переключаться в однопроводный режим в случае повреждения одной из линий. Работает на скоростях до 250 кбит\с. Уровни сигнала на шине отличаются от High Speed CAN, при этом не теряется возможность работы с шиной FT-CAN используя трансиверы High-Speed CAN и соблюдая ряд условий.

![[Pasted image 20241115135322.png]]
Fault tolerant CAN обычно используется для низкоскоростного обмена между блоками управления относящимися к сегменту сети Салон\Комфорт\Мультимедиа.

**ВАЖНО**: При подключении к шине Faul tolerant CAN, подключать терминальный резистор 120 Ом между линиями CAN-High и CAN-Low **НЕ НУЖНО** !

### 3 **Single Wire CAN или SW-CAN**

Однопроводный вариант шины CAN. Работает на скорости 33.333 кбит\с

Используется специальный тип трансиверов. Для того что бы подключиться к такому варианту шины CAN необходимо линию CAN-High анализатора подключить к шине SW-CAN а линию CAN-Low к массе\земле.

![[Pasted image 20241115135544.png]]

