### **–§–∏–∫—Å—Ç—É—Ä—ã –≤ `pytest`**

**–§–∏–∫—Å—Ç—É—Ä—ã** –≤ `pytest` ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è **–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π** –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∞–º–∏. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å** –Ω–∞—Å—Ç—Ä–æ–π–∫—É –∏ –æ—á–∏—Å—Ç–∫—É —Ä–µ—Å—É—Ä—Å–æ–≤, —É—Å—Ç—Ä–∞–Ω—è—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞.

---

## **1. –ó–∞—á–µ–º –Ω—É–∂–Ω—ã —Ñ–∏–∫—Å—Ç—É—Ä—ã?**

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –≤—Ä—É—á–Ω—É—é –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ç–µ—Å—Ç–æ–º, —Ñ–∏–∫—Å—Ç—É—Ä—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**.

**–ë–µ–∑ —Ñ–∏–∫—Å—Ç—É—Ä:**
```python
import pytest

def test_example():
    db = Database()  # –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
    db.connect()  # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
    assert db.is_connected
    db.disconnect()  # –û—á–∏—Å—Ç–∫–∞
```
–ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç —Ç—Ä–µ–±—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ—á–∏—Å—Ç–∫–∏ –æ–±—ä–µ–∫—Ç–∞. –ï—Å–ª–∏ —Ç–∞–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤ **–¥–µ—Å—è—Ç–∫–∏**, –∫–æ–¥ —Ä–∞–∑—Ä–∞—Å—Ç–∞–µ—Ç—Å—è.

**–° —Ñ–∏–∫—Å—Ç—É—Ä–æ–π:**
```python
@pytest.fixture
def db():
    db = Database()
    db.connect()
    yield db  # –ü–µ—Ä–µ–¥–∞—ë–º –æ–±—ä–µ–∫—Ç –≤ —Ç–µ—Å—Ç
    db.disconnect()  # –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞

def test_example(db):
    assert db.is_connected  # –§–∏–∫—Å—Ç—É—Ä–∞ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∞ –æ–±—ä–µ–∫—Ç
```
–¢–µ–ø–µ—Ä—å `db` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–æ–º –∏ –æ—á–∏—â–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –Ω–µ–≥–æ. üéØ

---

## **2. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Ñ–∏–∫—Å—Ç—É—Ä—ã?**

–§–∏–∫—Å—Ç—É—Ä–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ **—Ñ—É–Ω–∫—Ü–∏—è —Å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–º** `@pytest.fixture`, –∫–æ—Ç–æ—Ä–∞—è:  
-  **–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–æ–º**  
-  **–ú–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (yield)**  
-  **–û—á–∏—â–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞**

–ü—Ä–∏–º–µ—Ä:
```python
import pytest

@pytest.fixture
def example_data():
    print("\n–§–∏–∫—Å—Ç—É—Ä–∞: —Å–æ–∑–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ")
    return {"name": "Alice", "age": 30}

def test_user_data(example_data):
    assert example_data["name"] == "Alice"
```
–í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª–∏:
```python
–§–∏–∫—Å—Ç—É—Ä–∞: —Å–æ–∑–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ
```
–§–∏–∫—Å—Ç—É—Ä–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**!

---

## **3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `yield` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏**

–§–∏–∫—Å—Ç—É—Ä—ã –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å **–¥–µ–π—Å—Ç–≤–∏—è –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞**, –∏—Å–ø–æ–ª—å–∑—É—è `yield`.
```python
@pytest.fixture
def file():
    f = open("test.txt", "w")
    yield f  # –ü–µ—Ä–µ–¥–∞—á–∞ –≤ —Ç–µ—Å—Ç
    f.close()  # –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞
```
–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ `pytest` **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä–æ–µ—Ç —Ñ–∞–π–ª**.

---

## **4. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã `scope` (–û–±–ª–∞—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏—è)**

–§–∏–∫—Å—Ç—É—Ä—ã –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å **—Ä–∞–∑ –≤ —Ç–µ—Å—Ç, –∫–ª–∞—Å—Å –∏–ª–∏ –¥–∞–∂–µ –≤–æ –≤—Å–µ–π —Å–µ—Å—Å–∏–∏**.

|`scope`|–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è?|
|---|---|
|`function` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)|–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞|
|`class`|–û–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –∫–ª–∞—Å—Å–∞|
|`module`|–û–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –º–æ–¥—É–ª—è|
|`session`|–û–¥–∏–Ω —Ä–∞–∑ –∑–∞ –≤—Å—é —Å–µ—Å—Å–∏—é|

–ü—Ä–∏–º–µ—Ä:
```python
@pytest.fixture(scope="module")
def db():
    db = Database()
    db.connect()
    yield db
    db.disconnect()
```
–¢–µ–ø–µ—Ä—å —Ñ–∏–∫—Å—Ç—É—Ä–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **—Ä–∞–∑ –≤ –º–æ–¥—É–ª–µ** –≤–º–µ—Å—Ç–æ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞.

---

## **5. –§–∏–∫—Å—Ç—É—Ä—ã –º–æ–≥—É—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –¥—Ä—É–≥–∏—Ö —Ñ–∏–∫—Å—Ç—É—Ä**

–§–∏–∫—Å—Ç—É—Ä—ã –º–æ–≥—É—Ç **–≤—ã–∑—ã–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã**, —Å–æ–∑–¥–∞–≤–∞—è —Ü–µ–ø–æ—á–∫–∏.
```python
@pytest.fixture
def user_data():
    return {"name": "Alice", "age": 30}

@pytest.fixture
def full_user(user_data):
    user_data["email"] = "alice@example.com"
    return user_data

def test_user(full_user):
    assert full_user["email"] == "alice@example.com"
```
–ó–¥–µ—Å—å `full_user` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `user_data`, —Ä–∞—Å—à–∏—Ä—è—è –µ–≥–æ.

---

## **6. –ê–≤—Ç–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (`autouse=True`)**

–§–∏–∫—Å—Ç—É—Ä—ã –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å **–∞–≤—Ç–æ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏**, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏—Ö —è–≤–Ω–æ.
```python
@pytest.fixture(autouse=True)
def setup_env():
    print("\n–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ")
```
–¢–µ–ø–µ—Ä—å —ç—Ç–∞ —Ñ–∏–∫—Å—Ç—É—Ä–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ç–µ—Å—Ç–æ–º** –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö.