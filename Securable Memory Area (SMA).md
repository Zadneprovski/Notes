Securable Memory Area (SMA) — это аппаратно защищённая область основной flash-памяти STM32, предназначенная для однократного исполнения критически важного кода после сброса микроконтроллера. После первого выполнения доступ к SMA блокируется до следующего аппаратного сброса, что делает эту зону особенно полезной для реализации безопасной загрузки (secure boot) и хранения чувствительных данных, таких как криптографические ключи.
### Основное назначение

Главная цель SMA — изоляция и защита первой стадии загрузки (first-stage boot) от остальной части приложения. Код, размещённый в этой области, может выполнять задачи, связанные с доверием, такие как:

- Проверка цифровой подписи основной прошивки
- Расшифровка ключей
- Установка политик безопасности или включение TrustZone
- Блокировка возможности перезаписи себя

После однократного вызова код в SMA становится недоступным для чтения, записи и повторного исполнения.
### Поведение

- Область размещается в основной flash-памяти (Main Flash).
- Её размер конфигурируется через регистры `FLASH_SEC1R` и `FLASH_SEC2R`.
- Активация защиты осуществляется установкой бита `SEC_PROT1` или `SEC_PROT2` в регистре `FLASH_CR`.
- После вызова любого кода в SMA дальнейшие попытки чтения, программирования или исполнения вызывают ошибки (RDERR / WRPERR).
- Защита вступает в силу только после первого исполнения, позволяя при старте MCU один раз обратиться к SMA.
### Отличие от PCROP

В отличие от PCROP, который защищает код от чтения и записи, но позволяет его многократное выполнение, SMA предназначена для однократного вызова после сброса, что делает невозможным повторный доступ даже из самой прошивки.
### Применение

SMA используется в системах, требующих высокой степени безопасности, например:

- Безопасная загрузка (Secure Boot)
- Организация доверенного корня (Root of Trust)
- Аппаратная инициализация безопасности, проводимая до загрузки основной прошивки

Таким образом, Securable Memory Area предоставляет разработчику надёжный механизм аппаратной изоляции кода и данных, играющих ключевую роль в архитектуре защищённой системы.