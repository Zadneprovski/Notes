[[Шаблонные параметры без типов (Non-Type Template Parameters)]]
[[Шаблоны с переменным количеством параметров]]
[[typename и зависимые типы]]
[[Ограничение типа]]
[[Шаблоны по умолчанию]]
[[Инициализация статической переменной в шаблоне]]

Шаблоны в C++ (templates) — это мощный инструмент, позволяющий создавать обобщенные функции и классы. Они дают возможность писать код, который может работать с любыми типами данных, обеспечивая при этом безопасность типов и оптимизацию на этапе компиляции. Шаблоны широко используются для создания обобщенных алгоритмов и структур данных.

В С++ шаблоны (templates) требуют, чтобы определения функций были в заголовочных файлах. 

Исключением является случай, когда шаблонный метод используется только в том же файле, а не в другом cpp файле.

Это связано с тем, что компилятор должен видеть реализацию шаблона при компиляции каждого `.cpp`, где он вызывается.

Если он вызывается в других `.cpp` файлах, будет ошибка "undefined reference" при линковке.

```cpp
// mytemplate.hpp
template<typename T>
T add(T a, T b) {
    return a + b;
}
```


### Основные концепции шаблонов

1. **Функциональные шаблоны (Function Templates)**:
    Позволяют создавать обобщенные функции, которые могут принимать параметры любого типа.

```cpp
template <typename T>
T add(T a, T b) {
    return a + b;
}
```

2. **Классовые шаблоны (Class Templates)**:
    
    - Позволяют создавать обобщенные классы, которые могут работать с любыми типами данных.
  
```cpp
template <typename T>
class Array {
private:
    T* arr;
    int size;
public:
    Array(int s) : size(s) {
        arr = new T[size];
    }
    ~Array() {
        delete[] arr;
    }
    T& operator[](int index) {
        return arr[index];
    }
};
```


3. **Шаблоны с несколькими параметрами (Multiple Template Parameters)**:
    
    - Шаблоны могут иметь несколько параметров.

```cpp
template <typename T, typename U>
class Pair {
public:
    T first;
    U second;
    Pair(T f, U s) : first(f), second(s) {}
};
```


4. **Шаблонные параметры без типов (Non-Type Template Parameters)**:
    
    - Шаблоны могут принимать параметры, которые не являются типами, такие как целые числа или указатели на функции.

```cpp
template <typename T, int size>
class StaticArray {
private:
    T arr[size];
public:
    T& operator[](int index) {
        return arr[index];
    }
};
```

### Преимущества использования шаблонов

- **Обобщенность**: Шаблоны позволяют писать код, который работает с любыми типами данных, снижая необходимость дублирования кода для разных типов.
- **Безопасность типов**: Ошибки типов обнаруживаются на этапе компиляции, что делает программы более надежными.
- **Производительность**: Шаблоны инлайннируются и оптимизируются компилятором, что может приводить к более эффективному коду по сравнению с использованием виртуальных функций или других динамических механизмов.



### Особенности и ограничения шаблонов

- **Компиляция и отладка**: Шаблоны могут увеличивать время компиляции и усложнять процесс отладки из-за сложности диагностических сообщений.
- **Проблемы с зависимостью от типов**: Не все операции могут быть выполнены с любым типом данных, поэтому иногда требуется дополнительная проверка или специализация шаблонов.